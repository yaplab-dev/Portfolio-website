<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">    
    <script type="text/javascript" src="./js/portfolio.js"></script>
    
    <title>Pablo Fonseca</title>
    <link rel="icon" href="img/F.png"> <!-- tab icon -->
    
    <link rel="stylesheet" type="text/css" href="css/alosia.css"> <!-- Style sheet -->
    <!-- IMPORT GOOGLE FONTS -->
    <!-- Roboto -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,100..700;1,100..700&display=swap" rel="stylesheet">
    <!-- Space Mono-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet"> 
    <!-- Montserrat -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Roboto+Mono:ital,wght@0,100..700;1,100..700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- END OF GOOGLE FONTS IMPORTS-->

</head>
<body class="body-state1">

    <!-- HEADER SECTION -->
    <header>
          <div class="state1">
            <div class="glitch">
              <img src="img/alosia.png" class="poster" alt="Image of the piece ALOSIA by @balu_art and @gemalpu">
            </div>
            <a href="#" class="button" onclick="changeState(2)"><i class="fas fa-cut"></i>
            <h2 class="Cut sign">CUT HERE</h2></a>
          </div>
          <div class="state2" style="position:relative;">
            <img src="img/replace-main.png" class="poster2" alt="Image of the piece ALOSIA by @balu_art and @gemalpu">
            <img src="img/alosia-cut.png" class="eye" alt="watch out">
          </div>


          <div class="state1">
        <h1 id="state1-h1" data-value="ALOSIA">ALOSIA</h1>
      </div>
      <div class="state2">
      <h1 id="state2-h1" data-value="ALOSIA">ALOSIA</h1>
      </div>
    </header>
    
    <!-- Main Content-->
    <main>
        <h2>Gemalpu is watching</h2>    

    <!-- Marquesina (frame & glass) -->
    <div class="marquesina-frame">
        
        
        <!-- Rolling content -->

        <!-- Making off (Content 1)-->
    <div class="making-off">
            <!-- Video  -->
            <div class="video-container">
                <video autoplay="" loop="" muted="" class="overlay-video">
                    <source src="vid/Alosia.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>
            <!-- Instagram Embed -->
            <div class="instagram-embed-wrapper"> <!-- I'm wrapping the embed in a Div to force my style over the embed code-->
                <iframe class="instagram-media instagram-media-rendered" id="instagram-embed-0" src="https://www.instagram.com/reel/C5BmOZJsxaL/embed/?cr=1&amp;v=14&amp;wp=597&amp;rd=https%3A%2F%2Ffedellart.github.io&amp;rp=%2F#%7B%22ci%22%3A0%2C%22os%22%3A696.0999999940395%2C%22ls%22%3A27.5%2C%22le%22%3A115.19999998807907%7D" 
                allowtransparency="true" allowfullscreen="true" frameborder="0" height="857" data-instgrm-payload-id="instagram-media-payload-0" scrolling="no" 
                style="background: white; border-radius: 3px; border: 1px solid rgb(219, 219, 219); 
                box-shadow: none; display: block; margin: 0px 0px 12px; padding: 0px;"></iframe> 
                <script async="" src="//www.instagram.com/embed.js"></script>
            </div>
        </div>
    </div>

    
 <!-- Explanation Section-->
    <section class="explanation">
    <p>Why and where?</p>
        <ul>
            <li><a target="_blank" href="https://www.instagram.com/p/C4_PtJpKghy/?utm_source=ig_web_copy_link&igsh=MzRlODBiNWFlZA==">First appearance</a></li>
            <li><a target="_blank" href="https://www.instagram.com/balu_art/">What's next?</a></li>
            <li><a target="_blank" href="">Where can I see the piece now? (coming soon)</a></li>
        </ul>
    </section>
 </main>      

    <!-- Footer -->
   <footer>
        <p>Stay tuned to find out more about this @balu_art project & future collaborations. You can follow the artists @gemalpu & @balu_art on ig.
            Find out more about their work at <a class="robotto" target="_blank" href="//canal-gallery.com/artistas/balu">Canalgallery.com</a> and <a class="montserrat" target="_blank" href="//www.gemalpu.com/">Gemalpu.com</a>
        </p> 
    </footer>






<!-- ______________________________ JAVASCRIPT SECTION ______________________________ -->


<script src="https://cdn.jsdelivr.net/npm/gsap@3.5.1/dist/gsap.min.js"></script>
<script src="myCustomCode.js"></script>

<script>
  const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
  let state1Interval = null;
  let state2Interval = null;
  
  function animateText(target, continuous = false) {
    let iteration = 0;
  
    return setInterval(() => {
      target.innerText = target.innerText
        .split("")
        .map((letter, index) => {
          if (continuous) {
            return letters[Math.floor(Math.random() * 26)];
          }
          if (index < iteration) {
            return target.dataset.value[index];
          }
          return letters[Math.floor(Math.random() * 26)];
        })
        .join("");
  
      if (!continuous && iteration >= target.dataset.value.length) {
        clearInterval(state2Interval);
      }
  
      iteration += continuous ? 0 : 1 / 3;
    }, 30);
  }
  
  // Continuous animation for state 1
  state1Interval = animateText(document.querySelector("#state1-h1"), true);
  
  // Observe body class changes for state transition
  const bodyObserver = new MutationObserver(mutations => {
    mutations.forEach(mutation => {
      if (mutation.attributeName === "class") {
        const currentClass = document.body.getAttribute("class");
        if (currentClass === "body-state2" && state1Interval) {
          clearInterval(state1Interval); // Stop state 1 animation
        }
      }
    });
  });
  
  bodyObserver.observe(document.body, { attributes: true });
  
  // State 2 Scroll Animation without Cool down
  window.addEventListener("scroll", () => {
    const h1Element = document.querySelector("#state2-h1");
    const rect = h1Element.getBoundingClientRect();
    const isVisible = (rect.top >= 0) && (rect.bottom <= window.innerHeight);
  
    if (isVisible) {
      if (state2Interval) clearInterval(state2Interval);
      state2Interval = animateText(h1Element);
    }
  });
  </script>


  <script>
    function checkOverlap() {
  const eye = document.querySelector('.eye');
  const frame = document.querySelector('.marquesina-frame');
  const frameRect = frame.getBoundingClientRect();
  const eyeRect = eye.getBoundingClientRect();

  // Check if the .eye element overlaps with the .marquesina-frame
  const isOverlapping = !(eyeRect.bottom < frameRect.top || 
                          eyeRect.top > frameRect.bottom || 
                          eyeRect.right < frameRect.left || 
                          eyeRect.left > frameRect.right);

  // If they overlap, reduce the blur effect
  if (isOverlapping) {
    frame.style.setProperty('--frame-blur', '0.5px');
  } else {
    frame.style.setProperty('--frame-blur', '6px');
  }
}

// Listen for scroll events to check for overlap
window.addEventListener('scroll', checkOverlap);

// Check for overlap initially in case the .eye is already over the .marquesina-frame on load
checkOverlap();

  </script>

<script>
  function adjustH2Visibility() {
  const h2 = document.querySelector('main h2');
  const explanation = document.querySelector('.explanation');
  const h2Rect = h2.getBoundingClientRect();
  const explanationRect = explanation.getBoundingClientRect();

  // Check if main h2 overlaps with .explanation
  const isOverlapping = !(h2Rect.bottom < explanationRect.top || 
                          h2Rect.top > explanationRect.bottom);

  // Adjust opacity based on overlap
  if (isOverlapping) {
    h2.style.opacity = 0; // Make h2 invisible
  } else {
    h2.style.opacity = 1; // Make h2 fully visible
  }
}

// Listen for scroll events to adjust h2 visibility
window.addEventListener('scroll', adjustH2Visibility);

// Adjust h2 visibility initially in case of overlap on load
adjustH2Visibility();

</script>

<script>
  function adjustEyeScale() {
  const eye = document.querySelector('.eye');
  const explanation = document.querySelector('.explanation');
  const eyeRect = eye.getBoundingClientRect();
  const explanationRect = explanation.getBoundingClientRect();

  // Check if the .eye element overlaps with .explanation
  const isOverlapping = !(eyeRect.bottom < explanationRect.top || 
                          eyeRect.top > explanationRect.bottom || 
                          eyeRect.right < explanationRect.left || 
                          eyeRect.left > explanationRect.right);

  // Adjust scale based on overlap
  if (isOverlapping) {
    eye.style.transform = 'scale(0.5)'; // Make .eye smaller
  } else {
    eye.style.transform = 'scale(1)'; // Keep .eye at normal size
  }
}

// Listen for scroll events to adjust .eye scale
window.addEventListener('scroll', adjustEyeScale);

// Adjust .eye scale initially in case of overlap on load
adjustEyeScale();

gsap.registerPlugin(Flip);

const box = document.querySelector(".box"), 
originalContainer = document.querySelector(".originalContainer"),
newContainer = document.querySelector(".newContainer");

document.querySelector("button")

</script>

  

  </body>
  </html>

</body>
</html>